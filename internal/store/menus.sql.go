// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.30.0
// source: menus.sql

package store

import (
	"context"
	"database/sql"
	"time"
)

const countMenuItems = `-- name: CountMenuItems :one
SELECT COUNT(*) FROM menu_items WHERE menu_id = ?
`

func (q *Queries) CountMenuItems(ctx context.Context, menuID int64) (int64, error) {
	row := q.db.QueryRowContext(ctx, countMenuItems, menuID)
	var count int64
	err := row.Scan(&count)
	return count, err
}

const countMenus = `-- name: CountMenus :one
SELECT COUNT(*) FROM menus
`

func (q *Queries) CountMenus(ctx context.Context) (int64, error) {
	row := q.db.QueryRowContext(ctx, countMenus)
	var count int64
	err := row.Scan(&count)
	return count, err
}

const createMenu = `-- name: CreateMenu :one
INSERT INTO menus (name, slug, created_at, updated_at)
VALUES (?, ?, ?, ?)
RETURNING id, name, slug, created_at, updated_at
`

type CreateMenuParams struct {
	Name      string    `json:"name"`
	Slug      string    `json:"slug"`
	CreatedAt time.Time `json:"created_at"`
	UpdatedAt time.Time `json:"updated_at"`
}

func (q *Queries) CreateMenu(ctx context.Context, arg CreateMenuParams) (Menu, error) {
	row := q.db.QueryRowContext(ctx, createMenu,
		arg.Name,
		arg.Slug,
		arg.CreatedAt,
		arg.UpdatedAt,
	)
	var i Menu
	err := row.Scan(
		&i.ID,
		&i.Name,
		&i.Slug,
		&i.CreatedAt,
		&i.UpdatedAt,
	)
	return i, err
}

const createMenuItem = `-- name: CreateMenuItem :one

INSERT INTO menu_items (menu_id, parent_id, title, url, target, page_id, position, css_class, is_active, created_at, updated_at)
VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
RETURNING id, menu_id, parent_id, title, url, target, page_id, position, css_class, is_active, created_at, updated_at
`

type CreateMenuItemParams struct {
	MenuID    int64          `json:"menu_id"`
	ParentID  sql.NullInt64  `json:"parent_id"`
	Title     string         `json:"title"`
	Url       sql.NullString `json:"url"`
	Target    sql.NullString `json:"target"`
	PageID    sql.NullInt64  `json:"page_id"`
	Position  int64          `json:"position"`
	CssClass  sql.NullString `json:"css_class"`
	IsActive  bool           `json:"is_active"`
	CreatedAt time.Time      `json:"created_at"`
	UpdatedAt time.Time      `json:"updated_at"`
}

// Menu Item queries
func (q *Queries) CreateMenuItem(ctx context.Context, arg CreateMenuItemParams) (MenuItem, error) {
	row := q.db.QueryRowContext(ctx, createMenuItem,
		arg.MenuID,
		arg.ParentID,
		arg.Title,
		arg.Url,
		arg.Target,
		arg.PageID,
		arg.Position,
		arg.CssClass,
		arg.IsActive,
		arg.CreatedAt,
		arg.UpdatedAt,
	)
	var i MenuItem
	err := row.Scan(
		&i.ID,
		&i.MenuID,
		&i.ParentID,
		&i.Title,
		&i.Url,
		&i.Target,
		&i.PageID,
		&i.Position,
		&i.CssClass,
		&i.IsActive,
		&i.CreatedAt,
		&i.UpdatedAt,
	)
	return i, err
}

const deleteMenu = `-- name: DeleteMenu :exec
DELETE FROM menus WHERE id = ?
`

func (q *Queries) DeleteMenu(ctx context.Context, id int64) error {
	_, err := q.db.ExecContext(ctx, deleteMenu, id)
	return err
}

const deleteMenuItem = `-- name: DeleteMenuItem :exec
DELETE FROM menu_items WHERE id = ?
`

func (q *Queries) DeleteMenuItem(ctx context.Context, id int64) error {
	_, err := q.db.ExecContext(ctx, deleteMenuItem, id)
	return err
}

const deleteMenuItems = `-- name: DeleteMenuItems :exec
DELETE FROM menu_items WHERE menu_id = ?
`

func (q *Queries) DeleteMenuItems(ctx context.Context, menuID int64) error {
	_, err := q.db.ExecContext(ctx, deleteMenuItems, menuID)
	return err
}

const getMaxMenuItemPosition = `-- name: GetMaxMenuItemPosition :one
SELECT COALESCE(MAX(position), -1) FROM menu_items WHERE menu_id = ? AND (parent_id IS NULL OR parent_id = ?)
`

type GetMaxMenuItemPositionParams struct {
	MenuID   int64         `json:"menu_id"`
	ParentID sql.NullInt64 `json:"parent_id"`
}

func (q *Queries) GetMaxMenuItemPosition(ctx context.Context, arg GetMaxMenuItemPositionParams) (interface{}, error) {
	row := q.db.QueryRowContext(ctx, getMaxMenuItemPosition, arg.MenuID, arg.ParentID)
	var coalesce interface{}
	err := row.Scan(&coalesce)
	return coalesce, err
}

const getMenuByID = `-- name: GetMenuByID :one
SELECT id, name, slug, created_at, updated_at FROM menus WHERE id = ?
`

func (q *Queries) GetMenuByID(ctx context.Context, id int64) (Menu, error) {
	row := q.db.QueryRowContext(ctx, getMenuByID, id)
	var i Menu
	err := row.Scan(
		&i.ID,
		&i.Name,
		&i.Slug,
		&i.CreatedAt,
		&i.UpdatedAt,
	)
	return i, err
}

const getMenuBySlug = `-- name: GetMenuBySlug :one
SELECT id, name, slug, created_at, updated_at FROM menus WHERE slug = ?
`

func (q *Queries) GetMenuBySlug(ctx context.Context, slug string) (Menu, error) {
	row := q.db.QueryRowContext(ctx, getMenuBySlug, slug)
	var i Menu
	err := row.Scan(
		&i.ID,
		&i.Name,
		&i.Slug,
		&i.CreatedAt,
		&i.UpdatedAt,
	)
	return i, err
}

const getMenuItemByID = `-- name: GetMenuItemByID :one
SELECT id, menu_id, parent_id, title, url, target, page_id, position, css_class, is_active, created_at, updated_at FROM menu_items WHERE id = ?
`

func (q *Queries) GetMenuItemByID(ctx context.Context, id int64) (MenuItem, error) {
	row := q.db.QueryRowContext(ctx, getMenuItemByID, id)
	var i MenuItem
	err := row.Scan(
		&i.ID,
		&i.MenuID,
		&i.ParentID,
		&i.Title,
		&i.Url,
		&i.Target,
		&i.PageID,
		&i.Position,
		&i.CssClass,
		&i.IsActive,
		&i.CreatedAt,
		&i.UpdatedAt,
	)
	return i, err
}

const listChildMenuItems = `-- name: ListChildMenuItems :many
SELECT id, menu_id, parent_id, title, url, target, page_id, position, css_class, is_active, created_at, updated_at FROM menu_items WHERE parent_id = ? ORDER BY position ASC
`

func (q *Queries) ListChildMenuItems(ctx context.Context, parentID sql.NullInt64) ([]MenuItem, error) {
	rows, err := q.db.QueryContext(ctx, listChildMenuItems, parentID)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	items := []MenuItem{}
	for rows.Next() {
		var i MenuItem
		if err := rows.Scan(
			&i.ID,
			&i.MenuID,
			&i.ParentID,
			&i.Title,
			&i.Url,
			&i.Target,
			&i.PageID,
			&i.Position,
			&i.CssClass,
			&i.IsActive,
			&i.CreatedAt,
			&i.UpdatedAt,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Close(); err != nil {
		return nil, err
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const listMenuItems = `-- name: ListMenuItems :many
SELECT id, menu_id, parent_id, title, url, target, page_id, position, css_class, is_active, created_at, updated_at FROM menu_items WHERE menu_id = ? ORDER BY position ASC
`

func (q *Queries) ListMenuItems(ctx context.Context, menuID int64) ([]MenuItem, error) {
	rows, err := q.db.QueryContext(ctx, listMenuItems, menuID)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	items := []MenuItem{}
	for rows.Next() {
		var i MenuItem
		if err := rows.Scan(
			&i.ID,
			&i.MenuID,
			&i.ParentID,
			&i.Title,
			&i.Url,
			&i.Target,
			&i.PageID,
			&i.Position,
			&i.CssClass,
			&i.IsActive,
			&i.CreatedAt,
			&i.UpdatedAt,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Close(); err != nil {
		return nil, err
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const listMenuItemsWithPage = `-- name: ListMenuItemsWithPage :many

SELECT
    mi.id, mi.menu_id, mi.parent_id, mi.title, mi.url, mi.target, mi.page_id, mi.position, mi.css_class, mi.is_active, mi.created_at, mi.updated_at,
    p.title as page_title,
    p.slug as page_slug
FROM menu_items mi
LEFT JOIN pages p ON mi.page_id = p.id
WHERE mi.menu_id = ?
ORDER BY mi.position ASC
`

type ListMenuItemsWithPageRow struct {
	ID        int64          `json:"id"`
	MenuID    int64          `json:"menu_id"`
	ParentID  sql.NullInt64  `json:"parent_id"`
	Title     string         `json:"title"`
	Url       sql.NullString `json:"url"`
	Target    sql.NullString `json:"target"`
	PageID    sql.NullInt64  `json:"page_id"`
	Position  int64          `json:"position"`
	CssClass  sql.NullString `json:"css_class"`
	IsActive  bool           `json:"is_active"`
	CreatedAt time.Time      `json:"created_at"`
	UpdatedAt time.Time      `json:"updated_at"`
	PageTitle sql.NullString `json:"page_title"`
	PageSlug  sql.NullString `json:"page_slug"`
}

// Menu item with page info
func (q *Queries) ListMenuItemsWithPage(ctx context.Context, menuID int64) ([]ListMenuItemsWithPageRow, error) {
	rows, err := q.db.QueryContext(ctx, listMenuItemsWithPage, menuID)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	items := []ListMenuItemsWithPageRow{}
	for rows.Next() {
		var i ListMenuItemsWithPageRow
		if err := rows.Scan(
			&i.ID,
			&i.MenuID,
			&i.ParentID,
			&i.Title,
			&i.Url,
			&i.Target,
			&i.PageID,
			&i.Position,
			&i.CssClass,
			&i.IsActive,
			&i.CreatedAt,
			&i.UpdatedAt,
			&i.PageTitle,
			&i.PageSlug,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Close(); err != nil {
		return nil, err
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const listMenus = `-- name: ListMenus :many
SELECT id, name, slug, created_at, updated_at FROM menus ORDER BY name ASC
`

func (q *Queries) ListMenus(ctx context.Context) ([]Menu, error) {
	rows, err := q.db.QueryContext(ctx, listMenus)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	items := []Menu{}
	for rows.Next() {
		var i Menu
		if err := rows.Scan(
			&i.ID,
			&i.Name,
			&i.Slug,
			&i.CreatedAt,
			&i.UpdatedAt,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Close(); err != nil {
		return nil, err
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const listTopLevelMenuItems = `-- name: ListTopLevelMenuItems :many
SELECT id, menu_id, parent_id, title, url, target, page_id, position, css_class, is_active, created_at, updated_at FROM menu_items WHERE menu_id = ? AND parent_id IS NULL ORDER BY position ASC
`

func (q *Queries) ListTopLevelMenuItems(ctx context.Context, menuID int64) ([]MenuItem, error) {
	rows, err := q.db.QueryContext(ctx, listTopLevelMenuItems, menuID)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	items := []MenuItem{}
	for rows.Next() {
		var i MenuItem
		if err := rows.Scan(
			&i.ID,
			&i.MenuID,
			&i.ParentID,
			&i.Title,
			&i.Url,
			&i.Target,
			&i.PageID,
			&i.Position,
			&i.CssClass,
			&i.IsActive,
			&i.CreatedAt,
			&i.UpdatedAt,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Close(); err != nil {
		return nil, err
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const menuSlugExists = `-- name: MenuSlugExists :one
SELECT EXISTS(SELECT 1 FROM menus WHERE slug = ?)
`

func (q *Queries) MenuSlugExists(ctx context.Context, slug string) (int64, error) {
	row := q.db.QueryRowContext(ctx, menuSlugExists, slug)
	var column_1 int64
	err := row.Scan(&column_1)
	return column_1, err
}

const menuSlugExistsExcluding = `-- name: MenuSlugExistsExcluding :one
SELECT EXISTS(SELECT 1 FROM menus WHERE slug = ? AND id != ?)
`

type MenuSlugExistsExcludingParams struct {
	Slug string `json:"slug"`
	ID   int64  `json:"id"`
}

func (q *Queries) MenuSlugExistsExcluding(ctx context.Context, arg MenuSlugExistsExcludingParams) (int64, error) {
	row := q.db.QueryRowContext(ctx, menuSlugExistsExcluding, arg.Slug, arg.ID)
	var column_1 int64
	err := row.Scan(&column_1)
	return column_1, err
}

const updateMenu = `-- name: UpdateMenu :one
UPDATE menus SET name = ?, slug = ?, updated_at = ?
WHERE id = ?
RETURNING id, name, slug, created_at, updated_at
`

type UpdateMenuParams struct {
	Name      string    `json:"name"`
	Slug      string    `json:"slug"`
	UpdatedAt time.Time `json:"updated_at"`
	ID        int64     `json:"id"`
}

func (q *Queries) UpdateMenu(ctx context.Context, arg UpdateMenuParams) (Menu, error) {
	row := q.db.QueryRowContext(ctx, updateMenu,
		arg.Name,
		arg.Slug,
		arg.UpdatedAt,
		arg.ID,
	)
	var i Menu
	err := row.Scan(
		&i.ID,
		&i.Name,
		&i.Slug,
		&i.CreatedAt,
		&i.UpdatedAt,
	)
	return i, err
}

const updateMenuItem = `-- name: UpdateMenuItem :one
UPDATE menu_items SET parent_id = ?, title = ?, url = ?, target = ?, page_id = ?, position = ?, css_class = ?, is_active = ?, updated_at = ?
WHERE id = ?
RETURNING id, menu_id, parent_id, title, url, target, page_id, position, css_class, is_active, created_at, updated_at
`

type UpdateMenuItemParams struct {
	ParentID  sql.NullInt64  `json:"parent_id"`
	Title     string         `json:"title"`
	Url       sql.NullString `json:"url"`
	Target    sql.NullString `json:"target"`
	PageID    sql.NullInt64  `json:"page_id"`
	Position  int64          `json:"position"`
	CssClass  sql.NullString `json:"css_class"`
	IsActive  bool           `json:"is_active"`
	UpdatedAt time.Time      `json:"updated_at"`
	ID        int64          `json:"id"`
}

func (q *Queries) UpdateMenuItem(ctx context.Context, arg UpdateMenuItemParams) (MenuItem, error) {
	row := q.db.QueryRowContext(ctx, updateMenuItem,
		arg.ParentID,
		arg.Title,
		arg.Url,
		arg.Target,
		arg.PageID,
		arg.Position,
		arg.CssClass,
		arg.IsActive,
		arg.UpdatedAt,
		arg.ID,
	)
	var i MenuItem
	err := row.Scan(
		&i.ID,
		&i.MenuID,
		&i.ParentID,
		&i.Title,
		&i.Url,
		&i.Target,
		&i.PageID,
		&i.Position,
		&i.CssClass,
		&i.IsActive,
		&i.CreatedAt,
		&i.UpdatedAt,
	)
	return i, err
}

const updateMenuItemPosition = `-- name: UpdateMenuItemPosition :exec
UPDATE menu_items SET parent_id = ?, position = ?, updated_at = ?
WHERE id = ?
`

type UpdateMenuItemPositionParams struct {
	ParentID  sql.NullInt64 `json:"parent_id"`
	Position  int64         `json:"position"`
	UpdatedAt time.Time     `json:"updated_at"`
	ID        int64         `json:"id"`
}

func (q *Queries) UpdateMenuItemPosition(ctx context.Context, arg UpdateMenuItemPositionParams) error {
	_, err := q.db.ExecContext(ctx, updateMenuItemPosition,
		arg.ParentID,
		arg.Position,
		arg.UpdatedAt,
		arg.ID,
	)
	return err
}
