{{define "content"}}
<div class="page-header">
    <div>
        <h1 class="page-title">{{.Data.Provider.Name}}</h1>
        <p class="page-description">{{.Data.Provider.Description}}</p>
    </div>
</div>

<form method="POST" action="/admin/embed/{{.Data.Provider.ID}}" class="embed-form">
    {{.CSRFField}}

    <div class="card">
        <div class="card-header">
            <div class="provider-header">
                <div class="provider-logo">
                    {{if eq .Data.Provider.ID "dify"}}
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/>
                        <path d="M8 10h.01"/>
                        <path d="M12 10h.01"/>
                        <path d="M16 10h.01"/>
                    </svg>
                    {{else}}
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <rect width="18" height="18" x="3" y="3" rx="2"/>
                        <path d="M7 7h10"/>
                        <path d="M7 12h10"/>
                        <path d="M7 17h10"/>
                    </svg>
                    {{end}}
                </div>
                <div class="provider-info">
                    <h2>{{T .AdminLang "embed.settings_title"}}</h2>
                    <p>{{T .AdminLang "embed.settings_description"}}</p>
                </div>
                <label class="switch">
                    <input type="checkbox" name="is_enabled" value="1" {{if .Data.IsEnabled}}checked{{end}}>
                    <span class="slider"></span>
                </label>
            </div>
        </div>
        <div class="card-body">
            {{range .Data.Schema}}
            <div class="form-group">
                <label for="{{.ID}}">
                    {{.Name}}
                    {{if .Required}}<span class="required">*</span>{{end}}
                </label>
                {{if eq .Type "select"}}
                <select id="{{.ID}}" name="{{.ID}}" class="form-control">
                    {{$default := .Default}}
                    {{range .Options}}
                    <option value="{{.Value}}" {{if eq .Value $default}}selected{{end}}>{{.Label}}</option>
                    {{end}}
                </select>
                {{else if eq .Type "color"}}
                <div class="color-input-group">
                    <input type="color"
                           id="{{.ID}}_picker"
                           value="{{if .Default}}{{.Default}}{{else}}#1C64F2{{end}}"
                           class="form-control-color"
                           onchange="document.getElementById('{{.ID}}').value = this.value">
                    <input type="text"
                           id="{{.ID}}"
                           name="{{.ID}}"
                           value="{{.Default}}"
                           placeholder="{{.Placeholder}}"
                           class="form-control"
                           pattern="^#[0-9A-Fa-f]{6}$"
                           onchange="document.getElementById('{{.ID}}_picker').value = this.value">
                </div>
                {{else if eq .Type "checkbox"}}
                <label class="checkbox-label">
                    <input type="checkbox" name="{{.ID}}" value="1" {{if eq .Default "1"}}checked{{end}}>
                    <span>{{.Description}}</span>
                </label>
                {{else if eq .Type "textarea"}}
                <textarea id="{{.ID}}"
                          name="{{.ID}}"
                          placeholder="{{.Placeholder}}"
                          class="form-control"
                          rows="4">{{.Default}}</textarea>
                {{else}}
                <input type="{{if eq .Type "url"}}url{{else}}text{{end}}"
                       id="{{.ID}}"
                       name="{{.ID}}"
                       value="{{.Default}}"
                       placeholder="{{.Placeholder}}"
                       class="form-control"
                       maxlength="{{if eq .Type "url"}}2048{{else}}255{{end}}"
                       {{if .Required}}required{{end}}>
                {{end}}
                {{if and .Description (ne .Type "checkbox")}}
                <small class="form-text">{{.Description}}</small>
                {{end}}
            </div>
            {{end}}
        </div>
    </div>

    <div class="form-actions">
        <a href="/admin/embed" class="btn btn-secondary">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="m15 18-6-6 6-6"/>
            </svg>
            {{T .AdminLang "embed.back_button"}}
        </a>
        <button type="submit" class="btn btn-primary">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/>
                <polyline points="17 21 17 13 7 13 7 21"/>
                <polyline points="7 3 7 8 15 8"/>
            </svg>
            {{T .AdminLang "embed.save_button"}}
        </button>
    </div>
</form>

<style>
.embed-form .card {
    margin-bottom: 1.5rem;
}

.provider-header {
    display: flex;
    align-items: center;
    gap: 1rem;
}

.provider-logo {
    width: 48px;
    height: 48px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--primary-color, #3b82f6);
    color: white;
    border-radius: 8px;
}

.provider-info {
    flex: 1;
}

.provider-info h2 {
    margin: 0 0 0.25rem 0;
    font-size: 1.125rem;
}

.provider-info p {
    margin: 0;
    color: var(--text-muted, #6b7280);
    font-size: 0.875rem;
}

.form-group {
    margin-bottom: 1.25rem;
}

.form-group label {
    display: block;
    margin-bottom: 0.5rem;
    font-weight: 500;
}

.form-group .required {
    color: var(--danger-color, #ef4444);
}

.form-text {
    display: block;
    margin-top: 0.25rem;
    color: var(--text-muted, #6b7280);
    font-size: 0.875rem;
}

.color-input-group {
    display: flex;
    gap: 0.5rem;
}

.form-control-color {
    width: 50px;
    height: 38px;
    padding: 0.25rem;
    border: 1px solid var(--border-color, #d1d5db);
    border-radius: 4px;
    cursor: pointer;
}

.checkbox-label {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-weight: normal;
    cursor: pointer;
}

.checkbox-label input[type="checkbox"] {
    width: 18px;
    height: 18px;
}

.form-actions {
    display: flex;
    gap: 1rem;
    justify-content: flex-end;
}
</style>
{{end}}
