{{define "content"}}
<div class="page-header">
    <h1 class="page-title">{{T .AdminLang "forms.submissions"}} - {{.Data.Form.Name}}</h1>
    <div class="page-actions">
        {{if and .Data.Submissions (not (isDemoMode))}}
        <form action="/admin/forms/{{.Data.Form.ID}}/submissions/export" method="POST" class="d-inline">
            {{.CSRFField}}
            <button type="submit" class="btn btn-secondary">{{T .AdminLang "forms.export_csv"}}</button>
        </form>
        {{end}}
        <a href="/admin/forms/{{.Data.Form.ID}}" class="btn btn-outline">{{T .AdminLang "forms.back_to_form"}}</a>
    </div>
</div>

<div class="stats-bar">
    <div class="stat">
        <span class="stat-value">{{.Data.TotalCount}}</span>
        <span class="stat-label">{{T .AdminLang "forms.total_submissions"}}</span>
    </div>
    <div class="stat">
        <span class="stat-value">{{.Data.UnreadCount}}</span>
        <span class="stat-label">{{T .AdminLang "forms.unread"}}</span>
    </div>
</div>

{{if .Data.Submissions}}
<div class="table-container">
    <table class="table">
        <thead>
            <tr>
                <th class="col-w-60">ID</th>
                <th>{{T .AdminLang "forms.preview"}}</th>
                <th class="col-w-160">{{T .AdminLang "forms.submitted"}}</th>
                <th class="col-w-120">{{T .AdminLang "forms.ip_address"}}</th>
                <th class="col-w-80">{{T .AdminLang "label.status"}}</th>
                <th class="col-w-150">{{T .AdminLang "label.actions"}}</th>
            </tr>
        </thead>
        <tbody>
            {{range .Data.Submissions}}
            <tr{{if not .Submission.IsRead}} class="unread"{{end}}>
                <td>
                    <a href="/admin/forms/{{$.Data.Form.ID}}/submissions/{{.Submission.ID}}" class="link-primary">
                        #{{.Submission.ID}}
                    </a>
                </td>
                <td>
                    <a href="/admin/forms/{{$.Data.Form.ID}}/submissions/{{.Submission.ID}}" class="submission-preview">
                        {{if .Preview}}{{.Preview}}{{else}}<em>{{T $.AdminLang "forms.no_preview"}}</em>{{end}}
                    </a>
                </td>
                <td>{{formatDateTime .Submission.CreatedAt}}</td>
                <td>
                    {{if .Submission.IpAddress.Valid}}
                    <code>{{maskIP .Submission.IpAddress.String}}</code>
                    {{else}}
                    <span class="text-muted">-</span>
                    {{end}}
                </td>
                <td>
                    {{if .Submission.IsRead}}
                    <span class="badge badge-secondary">{{T $.AdminLang "forms.status_read"}}</span>
                    {{else}}
                    <span class="badge badge-primary">{{T $.AdminLang "forms.status_new"}}</span>
                    {{end}}
                </td>
                <td>
                    <div class="btn-group">
                        <a href="/admin/forms/{{$.Data.Form.ID}}/submissions/{{.Submission.ID}}" class="btn btn-sm btn-secondary">{{T $.AdminLang "forms.view"}}</a>
                        <button type="button"
                                class="btn btn-sm btn-danger"
                                hx-delete="/admin/forms/{{$.Data.Form.ID}}/submissions/{{.Submission.ID}}"
                                hx-confirm="{{T $.AdminLang "forms.confirm_delete_submission"}}"
                                hx-target="closest tr"
                                hx-swap="outerHTML">
                            {{T $.AdminLang "btn.delete"}}
                        </button>
                    </div>
                </td>
            </tr>
            {{end}}
        </tbody>
    </table>
</div>

{{if .Data.Pagination.ShouldShow}}
<div class="card-footer">
    {{template "pagination" (dict "Pagination" .Data.Pagination "AdminLang" .AdminLang)}}
</div>
{{end}}

{{else}}
<div class="card">
    <div class="card-body">
        <div class="empty-state">
            <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>
            <p>{{T .AdminLang "forms.no_submissions"}}</p>
            <span class="empty-hint">{{T .AdminLang "forms.no_submissions_hint"}}</span>
            <div class="empty-state-action">
                <a href="/forms/{{.Data.Form.Slug}}" class="btn btn-primary" target="_blank">{{T .AdminLang "forms.view_form"}}</a>
            </div>
        </div>
    </div>
</div>
{{end}}
{{end}}
