{{define "content"}}
<div class="dev-page-layout">
    <div class="dev-search-page">
        <header class="dev-search-header">
            <h1 class="dev-search-title">
                <span class="dev-comment">// </span>{{TTheme .LangCode "search.title"}}
            </h1>
            <form action="{{.LangPrefix}}/search" method="get" class="dev-search-form">
                <div class="dev-search-input-wrapper">
                    <span class="dev-prompt">$</span>
                    <span class="dev-grep">grep -ri "</span>
                    <input type="search" name="q" value="{{.SearchQuery}}" placeholder="query" class="dev-search-input" aria-label="Search query" autofocus>
                    <span class="dev-grep">" ./content</span>
                </div>
                <button type="submit" class="dev-btn dev-btn-primary">Execute</button>
            </form>
        </header>

        {{if .SearchQuery}}
        <div class="dev-search-results">
            {{if .Pages}}
            <div class="dev-results-header">
                <span class="dev-comment">// </span>
                {{if eq .ResultCount 1}}{{TTheme .LangCode "search.result_count" .ResultCount}}{{else}}{{TTheme .LangCode "search.results_count" .ResultCount}}{{end}} "<code>{{.SearchQuery}}</code>"
            </div>

            <div class="dev-posts-list">
                {{range .Pages}}
                <article class="dev-post-item dev-search-result">
                    {{if .FeaturedImage}}
                    <div class="dev-post-image">
                        <a href="{{.URL}}">
                            <img src="{{.FeaturedImage}}" alt="{{.Title}}" loading="lazy">
                        </a>
                    </div>
                    {{end}}
                    <div class="dev-post-content">
                        {{if .Category}}
                        <span class="dev-post-category">
                            <a href="{{$.LangPrefix}}/category/{{.Category.Slug}}">{{.Category.Name}}</a>
                        </span>
                        {{end}}
                        <h2 class="dev-post-title">
                            <a href="{{.URL}}">{{.Title}}</a>
                        </h2>
                        {{if .Highlight}}
                        <p class="dev-search-highlight">{{safeHTML .Highlight}}</p>
                        {{else if .Excerpt}}
                        <p class="dev-post-excerpt">{{.Excerpt}}</p>
                        {{end}}
                        <div class="dev-post-meta">
                            {{if .PublishedAt}}
                            <time datetime="{{.PublishedAt}}" class="dev-meta-item">
                                {{formatDateLocale .PublishedAt $.LangCode}}
                            </time>
                            {{end}}
                            <span class="dev-meta-item dev-post-type">{{.Type}}</span>
                        </div>
                    </div>
                </article>
                {{end}}
            </div>

            {{template "pagination.html" .}}

            {{else}}
            <div class="dev-no-results">
                <div class="dev-terminal">
                    <div class="dev-terminal-header">
                        <span class="dev-terminal-dot red"></span>
                        <span class="dev-terminal-dot yellow"></span>
                        <span class="dev-terminal-dot green"></span>
                    </div>
                    <div class="dev-terminal-body">
                        <div class="dev-terminal-line">
                            <span class="dev-prompt">$</span>
                            <span class="dev-command">grep -ri "{{.SearchQuery}}" ./content</span>
                        </div>
                        <p class="dev-output dev-error">{{TTheme $.LangCode "search.no_results"}} "{{.SearchQuery}}"</p>
                    </div>
                </div>
                <div class="dev-search-suggestions">
                    <h3>
                        <span class="dev-comment">// </span>{{TTheme $.LangCode "search.suggestions_title"}}
                    </h3>
                    <ul class="dev-suggestions-list">
                        <li><span class="dev-arrow">&gt;</span> {{TTheme $.LangCode "search.suggestion_spelling"}}</li>
                        <li><span class="dev-arrow">&gt;</span> {{TTheme $.LangCode "search.suggestion_keywords"}}</li>
                        <li><span class="dev-arrow">&gt;</span> {{TTheme $.LangCode "search.suggestion_general"}}</li>
                    </ul>
                </div>
            </div>
            {{end}}
        </div>
        {{else}}
        <div class="dev-search-intro">
            <div class="dev-terminal">
                <div class="dev-terminal-header">
                    <span class="dev-terminal-dot red"></span>
                    <span class="dev-terminal-dot yellow"></span>
                    <span class="dev-terminal-dot green"></span>
                    <span class="dev-terminal-title">search.sh</span>
                </div>
                <div class="dev-terminal-body">
                    <p class="dev-output">{{TTheme .LangCode "search.intro"}}</p>
                    <div class="dev-terminal-line">
                        <span class="dev-prompt">$</span>
                        <span class="dev-blink">_</span>
                    </div>
                </div>
            </div>

            {{if .PopularSearches}}
            <div class="dev-popular-searches">
                <h3>
                    <span class="dev-comment">// </span>{{TTheme .LangCode "search.popular_title"}}
                </h3>
                <ul class="dev-query-list">
                    {{range .PopularSearches}}
                    <li>
                        <a href="{{$.LangPrefix}}/search?q={{.}}" class="dev-query-link">
                            <span class="dev-prompt">$</span> grep "{{.}}"
                        </a>
                    </li>
                    {{end}}
                </ul>
            </div>
            {{end}}
        </div>
        {{end}}
    </div>

    {{template "sidebar.html" .}}
</div>
{{end}}
