{{define "sidebar.html"}}
<div class="sidebar">
    {{/* Search Widget */}}
    {{if .ShowSearch}}
    <div class="widget widget-search">
        <h3 class="widget-title">{{TTheme .LangCode "search.title"}}</h3>
        <form action="{{$.LangPrefix}}/search" method="get" class="search-form">
            <input type="search" name="q" placeholder="{{TTheme .LangCode "search.placeholder"}}" value="{{.SearchQuery}}" aria-label="{{TTheme .LangCode "search.title"}}">
            <button type="submit">{{TTheme .LangCode "search.button"}}</button>
        </form>
    </div>
    {{end}}

    {{/* Categories Widget */}}
    {{if .Categories}}
    <div class="widget widget-categories">
        <h3 class="widget-title">{{TTheme .LangCode "sidebar.categories"}}</h3>
        <ul class="category-list">
            {{range .Categories}}
            <li>
                <a href="{{$.LangPrefix}}/category/{{.Slug}}">{{.Name}}</a>
                {{if .Count}}<span class="count">({{.Count}})</span>{{end}}
            </li>
            {{end}}
        </ul>
    </div>
    {{end}}

    {{/* Tags Widget */}}
    {{if .Tags}}
    <div class="widget widget-tags">
        <h3 class="widget-title">{{TTheme .LangCode "sidebar.tags"}}</h3>
        <div class="tag-cloud">
            {{range .Tags}}
            <a href="{{$.LangPrefix}}/tag/{{.Slug}}" class="tag">{{.Name}}</a>
            {{end}}
        </div>
    </div>
    {{end}}

    {{/* Recent Posts Widget */}}
    {{if .RecentPosts}}
    <div class="widget widget-recent-posts">
        <h3 class="widget-title">{{TTheme .LangCode "sidebar.recent_posts"}}</h3>
        <ul class="recent-posts-list">
            {{range .RecentPosts}}
            <li>
                <a href="{{.URL}}">{{.Title}}</a>
                {{if .Date}}<span class="post-date">{{.Date}}</span>{{end}}
            </li>
            {{end}}
        </ul>
    </div>
    {{end}}

    {{/* Dynamic Widgets from Admin */}}
    {{if .Widgets}}
    {{with index .Widgets "sidebar"}}
    {{range .}}
    <div class="widget widget-{{.Type}}">
        {{if .Title}}<h3 class="widget-title">{{.Title}}</h3>{{end}}
        <div class="widget-content">
            {{.Content}}
        </div>
    </div>
    {{end}}
    {{end}}
    {{end}}
</div>
{{end}}
